{"version":3,"file":"dialog.js","mappings":"CAAA,WACE,aA2DA,SAASA,EAAUC,EAAMC,GACvBC,aAAaF,GAAM,SAASG,EAAOC,GAC7BA,GACFC,EAAE,wBAAwBC,OAC1BD,EAAE,eAAeE,KAAKC,KAAKC,UAAUL,EAAO,KAAM,IAClDC,EAAE,kBAAkBK,OAChBT,GAAUA,GAAS,KAEvBI,EAAE,kBAAkBC,OACpBK,cAAcN,EAAE,cAAeF,EAAOS,GACtCP,EAAE,wBAAwBK,OACtBT,GAAUA,GAAS,OAK7B,SAASW,IACPP,EAAE,gBAAgBQ,YAAY,eAAeC,WAAW,WACxDT,EAAEU,MAAMC,SAAS,gBAAgBC,SAAS,eAAeC,KAAK,UAAW,WACzEb,EAAE,2BAA2BC,OAC7BD,EAAE,kBAAkBS,WAAW,YAOjC,SAASK,EAAmBC,EAAMC,GAC3BA,IACHA,EAAMC,OAAOC,SAASC,MAExBJ,EAAOA,EAAKK,QAAQ,UAAW,QAC/B,IACEC,EADU,IAAIC,OAAO,OAASP,EAAO,qBACrBQ,KAAKP,GACvB,OAAKK,EACAA,EAAQ,GACNG,mBAAmBH,EAAQ,GAAGD,QAAQ,MAAO,MAD5B,GADH,KA1FvBK,OAAOC,WAAa,SAASC,GAC3BC,OAAOC,UAAUC,OAAM,WACrB,GAAIb,OAAOC,SAASa,OAGlB,GADWjB,EAAmB,QAE5Bd,EAAE,2BAA2BK,WACxB,CAGL,IAAIV,EAAOmB,EAAmB,kBAC1BkB,EAASlB,EAAmB,iBAEhCd,EAAE,gBAAgBiC,IAAItC,GACtBD,EAAUC,GAAM,SAASuC,GACnBA,IACFlC,EAAE,gBAAgBQ,YAAY,eAC9BR,EAAE,SAASmC,QAAO,WAChB,OAAOzB,KAAK0B,QAAUJ,KACrBpB,SAAS,eAAeC,KAAK,UAAW,WAC3Cb,EAAE,kBAAkBS,WAAW,gBAQvCT,EAAE,gBAAgBqC,GAAG,UAAU,WAC7BrC,EAAE,cAAcsC,QAChB,IAAIC,EAASvC,EAAE,gBAAgBiC,MAC3BM,EAAOC,OAAS,GAClB9C,EAAU6C,MAOdvC,EAAE,kBAAkBqC,GAAG,SAAS,WAC9B,IAAII,EAAW,GAEfA,EAASC,eAAiB1C,EAAE,gBAAgBiC,MAE5C,IAmCeU,EAnCXC,EAAe5C,EAAE,4BACjB4C,IACFH,EAASI,cAAgBD,EAAaX,MAiCzBU,EA/BDxC,KAAKC,UAAUqC,GAgCjChB,OAAOqB,QAAQC,GAAGC,cAAcL,WApFpC","sources":["webpack:///./src/settings/dialog.js?"],"sourcesContent":["(function(){\n  'use strict';\n\n  // The Office initialize function must be run each time a new page is loaded.\n  Office.initialize = function(reason){\n    jQuery(document).ready(function(){\n      if (window.location.search) {\n        // Check if warning should be displayed.\n        var warn = getParameterByName('warn');\n        if (warn) {\n          $('.not-configured-warning').show();\n        } else {\n          // See if the config values were passed.\n          // If so, pre-populate the values.\n          var user = getParameterByName('gitHubUserName');\n          var gistId = getParameterByName('defaultGistId');\n\n          $('#github-user').val(user);\n          loadGists(user, function(success){\n            if (success) {\n              $('.ms-ListItem').removeClass('is-selected');\n              $('input').filter(function() {\n                return this.value === gistId;\n              }).addClass('is-selected').attr('checked', 'checked');\n              $('#settings-done').removeAttr('disabled');\n            }\n          });\n        }\n      }\n\n      // When the GitHub username changes,\n      // try to load gists.\n      $('#github-user').on('change', function(){\n        $('#gist-list').empty();\n        var ghUser = $('#github-user').val();\n        if (ghUser.length > 0) {\n          loadGists(ghUser);\n        }\n      });\n\n      // When the Done button is selected, send the\n      // values back to the caller as a serialized\n      // object.\n      $('#settings-done').on('click', function() {\n        var settings = {};\n\n        settings.gitHubUserName = $('#github-user').val();\n\n        var selectedGist = $('.ms-ListItem.is-selected');\n        if (selectedGist) {\n          settings.defaultGistId = selectedGist.val();\n\n          sendMessage(JSON.stringify(settings));\n        }\n      });\n    });\n  };\n\n  // Load gists for the user using the GitHub API\n  // and build the list.\n  function loadGists(user, callback) {\n    getUserGists(user, function(gists, error){\n      if (error) {\n        $('.gist-list-container').hide();\n        $('#error-text').text(JSON.stringify(error, null, 2));\n        $('.error-display').show();\n        if (callback) callback(false);\n      } else {\n        $('.error-display').hide();\n        buildGistList($('#gist-list'), gists, onGistSelected);\n        $('.gist-list-container').show();\n        if (callback) callback(true);\n      }\n    });\n  }\n\n  function onGistSelected() {\n    $('.ms-ListItem').removeClass('is-selected').removeAttr('checked');\n    $(this).children('.ms-ListItem').addClass('is-selected').attr('checked', 'checked');\n    $('.not-configured-warning').hide();\n    $('#settings-done').removeAttr('disabled');\n  }\n\n  function sendMessage(message) {\n    Office.context.ui.messageParent(message);\n  }\n\n  function getParameterByName(name, url) {\n    if (!url) {\n      url = window.location.href;\n    }\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n      results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n  }\n})();"],"names":["loadGists","user","callback","getUserGists","gists","error","$","hide","text","JSON","stringify","show","buildGistList","onGistSelected","removeClass","removeAttr","this","children","addClass","attr","getParameterByName","name","url","window","location","href","replace","results","RegExp","exec","decodeURIComponent","Office","initialize","reason","jQuery","document","ready","search","gistId","val","success","filter","value","on","empty","ghUser","length","settings","gitHubUserName","message","selectedGist","defaultGistId","context","ui","messageParent"],"sourceRoot":""}